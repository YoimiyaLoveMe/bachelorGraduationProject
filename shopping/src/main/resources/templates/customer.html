<!DOCTYPE html>
<html lang="zh_CN" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" th:href="@{/static/layui/css/layui.css}" media="all">
	<link rel="stylesheet" th:href="@{/static/admin/style.css}" media="all">
	<script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
	<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

	<title>Electro - HTML Ecommerce Template</title>

	<!-- Google font -->
	<link href="https://fonts.googleapis.com/css?family=Montserrat:400,500,700" rel="stylesheet">

	<!-- Bootstrap -->
	<link type="text/css" rel="stylesheet" th:href="@{/static/shop/css/bootstrap.min.css}"/>

	<!-- Slick -->
	<link type="text/css" rel="stylesheet" th:href="@{/static/shop/css/slick.css}"/>
	<link type="text/css" rel="stylesheet" th:href="@{/static/shop/css/slick-theme.css}"/>

	<!-- nouislider -->
	<link type="text/css" rel="stylesheet" th:href="@{/static/shop/css/nouislider.min.css}"/>

	<!-- Font Awesome Icon -->
	<link rel="stylesheet" th:href="@{/static/shop/css/font-awesome.min.css}">

	<!-- Custom stlylesheet -->
	<link type="text/css" rel="stylesheet" th:href="@{/static/shop/css/style.css}"/>

	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]-->
	<!--		  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>-->
	<!--		  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>-->
	<!--[endif]-->

</head>
	<body>
		<!-- HEADER -->
		<header>
			<!-- TOP HEADER -->
			<div id="top-header">
				<div class="container">
					<ul class="header-links pull-left" id="door">

					</ul>
					<ul class="header-links pull-right">
						<li><a id="order"><i class="fa fa-dollar"></i>我的订单</a></li>
						<li><a id="account"><i class="fa fa-first-order"></i>我的账户</a></li>
					</ul>
				</div>
			</div>
			<!-- /TOP HEADER -->

			<!-- MAIN HEADER -->
			<div id="header">
				<!-- container -->
				<div class="container">
					<!-- row -->
					<div class="row">
						<!-- LOGO -->
						<div class="col-md-3">
							<div class="header-logo">
								<a href="/index" class="logo">
									<img src="../static/shop/img/index.png" alt="">
								</a>
							</div>
						</div>
						<!-- /LOGO -->

						<!-- SEARCH BAR -->
						<div class="col-md-5">
							<div class="header-search">
								<form>
									<select class="input-select">
										<option value="">All Categories</option>
										<option value="motherboard">主板</option>
										<option value="cpu">芯片</option>
										<option value="graphics_card">显卡</option>
										<option value="ram">内存</option>
										<option value="ssd">硬盘</option>
										<option value="heatsink">散热器</option>
										<option value="power">电源</option>
										<option value="case">机箱</option>
									</select>
									<input class="input" placeholder="商品名称">
									<button class="search-btn">搜索</button>
								</form>
							</div>
						</div>
						<!-- /SEARCH BAR -->

						<!-- ACCOUNT -->
						<div class="col-md-4 clearfix">
							<div class="header-ctn">

								<!-- Menu Toogle -->
								<div>
									<a href="#">
										<i class="fa fa-bars"></i>
										<span>商品列表</span>
									</a>
								</div>
								<!-- /Menu Toogle -->

								<!-- Wishlist -->
								<div>
									<a href="/goods/love">
										<i class="fa fa-heart-o"></i>
										<span>心愿单</span>
										<div class="qty" id="loveNumber"></div>
									</a>
								</div>
								<!-- /Wishlist -->

								<!-- Cart -->
								<div>
									<a href="#">
										<i class="fa fa-shopping-cart"></i>
										<span>购物车</span>
										<div class="qty" id="cartNumber"></div>
									</a>
								</div>
							</div>
							<!-- /Cart -->


						</div>
					</div>
					<!-- /ACCOUNT -->
				</div>
				<!-- row -->
			</div>
			<!-- container -->
			</div>
			<!-- /MAIN HEADER -->
		</header>
		<!-- /HEADER -->

		<!-- NAVIGATION -->
		<nav id="navigation">
			<!-- container -->
			<div class="container">
				<!-- responsive-nav -->
				<div id="responsive-nav">
					<!-- NAV -->
					<ul class="main-nav nav navbar-nav">
						<li id="love"><a href="javascript:changePage('love')">心愿单</a></li>
						<li id="cart"><a href="javascript:changePage('cart')">购物车</a></li>
						<li id="orderRetail"><a href="javascript:changePage('orderRetail')">订单记录</a></li>
						<li id="combination"><a href="javascript:changePage('combination')">装机配置单</a></li>
						<li id="orderCombination"><a href="javascript:changePage('orderCombination')">整机订单</a></li>
						<li id="ownInfo"><a href="javascript:changePage('ownInfo')">收货信息</a></li>
					</ul>
					<!-- /NAV -->
				</div>
				<!-- /responsive-nav -->
			</div>
			<!-- /container -->
		</nav>
		<!-- /NAVIGATION -->

		<!-- SECTION -->
		<div class="section">
			<!-- container -->
			<div class="container">
				<!-- row -->
				<div class="row" id="table">

				</div>
				<!-- /row -->
			</div>
			<!-- /container -->
		</div>
		<!-- /SECTION -->

		<!-- FOOTER -->
		<footer id="footer">
			<!-- top footer -->
			<div class="section">
				<!-- container -->
				<div class="container">
					<!-- row -->
					<div class="row">
						<div class="col-md-3 col-xs-6">
							<div class="footer">
								<h3 class="footer-title">About Us</h3>
								<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut.</p>
								<ul class="footer-links">
									<li><a href="#"><i class="fa fa-map-marker"></i>1734 Stonecoal Road</a></li>
									<li><a href="#"><i class="fa fa-phone"></i>+021-95-51-84</a></li>
									<li><a href="#"><i class="fa fa-envelope-o"></i>email@email.com</a></li>
								</ul>
							</div>
						</div>

						<div class="col-md-3 col-xs-6">
							<div class="footer">
								<h3 class="footer-title">Categories</h3>
								<ul class="footer-links">
									<li><a href="#">Hot deals</a></li>
									<li><a href="#">Laptops</a></li>
									<li><a href="#">Smartphones</a></li>
									<li><a href="#">Cameras</a></li>
									<li><a href="#">Accessories</a></li>
								</ul>
							</div>
						</div>

						<div class="clearfix visible-xs"></div>

						<div class="col-md-3 col-xs-6">
							<div class="footer">
								<h3 class="footer-title">Information</h3>
								<ul class="footer-links">
									<li><a href="#">About Us</a></li>
									<li><a href="#">Contact Us</a></li>
									<li><a href="#">Privacy Policy</a></li>
									<li><a href="#">Orders and Returns</a></li>
									<li><a href="#">Terms & Conditions</a></li>
								</ul>
							</div>
						</div>

						<div class="col-md-3 col-xs-6">
							<div class="footer">
								<h3 class="footer-title">Service</h3>
								<ul class="footer-links">
									<li><a href="#">My Account</a></li>
									<li><a href="#">View Cart</a></li>
									<li><a href="#">Wishlist</a></li>
									<li><a href="#">Track My Order</a></li>
									<li><a href="#">Help</a></li>
								</ul>
							</div>
						</div>
					</div>
					<!-- /row -->
				</div>
				<!-- /container -->
			</div>
			<!-- /top footer -->
		</footer>
		<!-- /FOOTER -->

		<!--<script th:src="@{/static/shop/js/jquery.min.js}"></script>-->
		<!--<script th:src="@{/static/shop/js/jquery.zoom.min.js}"></script>-->
		<script th:src="@{/static/shop/js/bootstrap.min.js}"></script>
		<script th:src="@{/static/shop/js/slick.min.js}"></script>
		<script th:src="@{/static/shop/js/nouislider.min.js}"></script>
		<script th:src="@{/static/shop/js/main.js}"></script>
		<script th:src="@{/static/layui/layui.js}"></script>

	<!--进入页面时跳转指定内容-->
	<script>
		$(document).ready(function (){
			var Page ='[[${Page}]]';
			$("#"+Page).attr("class","active");
			switch (Page) {
				case 'love':
					layui.use(['form', 'table'], function () {
						var $ = layui.$;
						var table = layui.table;
						$("#table").html(
								"<table className=\"layui-table\" id=\"demo\" lay-filter=\"demo\">" +
								"<thead>" +
								"<tr>" +
								"<th lay-data=\"{field:'id', align: 'center', hide: 'true'}\">商品id</th>" +//隐藏列
								"<th lay-data=\"{field:'name', align: 'center'}\">商品名称</th>" +
								"<th lay-data=\"{field:'category', align: 'center'}\">商品类别</th>" +
								"<th lay-data=\"{field:'picture', align: 'center',width:300}\">商品图片</th>" +
								"<th lay-data=\"{field:'salePrice', align: 'center', sort: true}\">商品售价</th>" +
								"<th lay-data=\"{title: '操作', align: 'center', width:150, toolbar: '#loveBar', fixed: 'right'}\">操作</th>" +
								"</tr>" +
								"</thead>" +
								"<tbody id=\"stock\">" +
								"</tbody>" +
								"</table>"
						);
						$.ajax({
							url: '/shop/getLove',
							dataType: 'json',
							type: 'POST',
							cache: false,
							success: function (list) {
								//动态生成静态表格
								for (var i = 0; i < list.length; i++) {
									$.ajax({
										url: '/goods/getGoods?id=' + list[i],
										dataType: 'json',
										type: 'POST',
										cache: false,
										success: function (data) {
											var category = null;
											switch (data.category) {
												case "motherboard":
													category = "主板";
													break;
												case "cpu":
													category = "芯片";
													break;
												case "graphicscard":
													category = "显卡";
													break;
												case "ram":
													category = "内存";
													break;
												case "ssd":
													category = "硬盘";
													break;
												case "heatsink":
													category = "散热器";
													break;
												case "power":
													category = "电源";
													break;
												case "case":
													category = "机箱";
													break;
												default:
													return null;
											}
											$('#stock').append("<tr><td>" + data.id + "</td><td>" + data.name + "</td><td>" + category + "</td><td><div><img src=\"../static/shop/img/" + data.picture + "\"></div></td><td>" + data.salePrice + "</td></tr>");
											//layui表格模块重新渲染
											table.init('demo', {
												height: 1000, //表格高度
												limit: 100, //每页显示数据量
											});
											table.on('tool(demo)', function (obj) {
												var data = obj.data;
												switch (obj.event) {
													case 'buy':
														location.href = "/goods/product?id=" + data.id
														break;
													case 'del':
														layer.confirm('确认删除？', function (index) {
															$.ajax({
																url: '/shop/delLove?id=' + data.id,
																data: null,
																async: false,
																cache: false,
																success: function (str) {
																	layer.msg(str.msg, {icon: str.icon, anim: str.anim});
																	location.href = "/goods/customer?type=love"
																}
															});
														})
														break;
												}
											});
										}
									})
								}
							}
						})
					});
					break;
				case 'cart':
					layui.use(['form', 'table'], function () {
						var $ = layui.$;
						var table = layui.table;
						$("#table").html(
								"<table className=\"layui-table\" id=\"demo\" lay-filter=\"demo\">" +
								"<thead>" +
								"<tr>" +
								"<th lay-data=\"{type:'checkbox' , fixed: 'left'}\"></th>" + //选中框
								"<th lay-data=\"{field:'id', align: 'center', hide: 'true'}\">商品id</th>" + //隐藏列
								"<th lay-data=\"{field:'name', align: 'center'}\">商品名称</th>" +
								"<th lay-data=\"{field:'category', align: 'center'}\">商品类别</th>" +
								"<th lay-data=\"{field:'picture', align: 'center',width:300}\">商品图片</th>" +
								"<th lay-data=\"{field:'salePrice', align: 'center', sort: true}\">商品售价</th>" +
								"<th lay-data=\"{field:'number', align: 'center', templet: '#cartInput', sort: true}\">数量</th>" +
								"<th lay-data=\"{title: '操作', align: 'center', width:150, toolbar: '#cartBar', fixed: 'right'}\">操作</th>" +
								"</tr>" +
								"</thead>" +
								"<tbody id=\"stock\">" +
								"</tbody>" +
								"</table>"
						);
						$.ajax({
							url: '/shop/getCart',
							dataType: 'json',
							type: 'POST',
							cache: false,
							success: function (map) {
								//采用遍历的方式取出map
								$.each(map, function (key, val) {
									$.ajax({
										url: '/goods/getGoods?id=' + key,
										dataType: 'json',
										type: 'POST',
										cache: false,
										success: function (data) {
											var category = null;
											switch (data.category) {
												case "motherboard":
													category = "主板";
													break;
												case "cpu":
													category = "芯片";
													break;
												case "graphicscard":
													category = "显卡";
													break;
												case "ram":
													category = "内存";
													break;
												case "ssd":
													category = "硬盘";
													break;
												case "heatsink":
													category = "散热器";
													break;
												case "power":
													category = "电源";
													break;
												case "case":
													category = "机箱";
													break;
												default:
													return null;
											}
											$('#stock').append("<tr><td></td>><td>" + data.id + "</td><td>" + data.name + "</td><td>" + category + "</td><td><div><img src=\"../static/shop/img/" + data.picture + "\"></div></td><td>" + data.salePrice + "</td><td>" + val + "</td></tr>");
											//layui表格模块重新渲染
											table.init('demo', {
												toolbar: '#cartList',
												height: 1000, //表格高度
												limit: 100, //每页显示数据量
											});
											table.on('tool(demo)', function (obj) {
												var data = obj.data;
												switch (obj.event) {
													case 'buy':
														//再次请求数据库
														$.ajax({
															url: '/shop/getCart',
															type: 'GET',
															data: null,
															async: false,
															cache: false,
															success: function (map) {
																$.each(map, function (key, val){
																	if(data.id == key)
																	location.href = "/goods/checkout?id=" + key + "&number=" + val;
																})

															}
														})
														break;
													case 'del':
														layer.confirm('确认删除？', function () {
															$.ajax({
																url: '/shop/delCart?id=' + data.id,
																data: null,
																async: false,
																cache: false,
																success: function (str) {
																	layer.msg(str.msg, {icon: str.icon, anim: str.anim});
																	location.href = "/goods/customer?type=cart"
																}
															});
														})
														break;
													case 'plus':
														$.ajax({
															url: '/shop/addCart?number=1&id=' + data.id,
															data: null,
															async: false,
															cache: false,
															success: function (str) {
																layer.msg(str.msg, {icon: str.icon, anim: str.anim});
															}
														});
														//为什么要先乘1：得到input是字符串，先使用乘可以隐式转化为数值，如果直接+1，则程序认为是字符串进行拼接
														$("#number").val($("#number").val()*1+1);
														break;
													case 'reduce':
														$.ajax({
															url: '/shop/addCart?number=-1&id=' + data.id,
															data: null,
															async: false,
															cache: false,
															success: function (str) {
																layer.msg(str.msg, {icon: str.icon, anim: str.anim});
															}
														});
														$("#number").val($("#number").val()*1-1);
														break;
												}
											});
											//监听头工具栏事件（结算选中）
											table.on('toolbar(demo)', function (obj) {
												switch (obj.event) {
													case 'buyCheck':
														//layui.table.cache.demo : 当前表格所有数据
														var data = layui.table.cache.demo;
														//结算商品列表
														var array =[]
														//遍历判断
														for (var i=0;i<data.length;i++){
															if (data[i].LAY_CHECKED){
																array.push(data[i].id)
															}
														}
														if(array.length != 0){
															location.href="/goods/checkoutCart?cart="+array.join();
														}else {
															alert("还未选中商品！")
														}
														// array.forEach(function (value, index, array){
														// })
														// 另一种获取选中复选框的方法
														// var check = table.checkStatus('demo')
														// var array = []
														// $(check.data).each(function (i,o){//o是行数据
														// 	array.push(o.id);
														break;
													}
											})
										}
									})
								});
							}
						})
					});
					break;
				case 'orderRetail':
					layui.use(['form', 'table'], function () {
						var $ = layui.$;
						var table = layui.table;
						$("#table").html("<table className=\"layui-table\" id=\"demo\" lay-filter=\"demo\"></table>");
						table.render({
							elem: '#demo',
							height: 2470,
							url: '/shop/orderRetailQueryPage',
							method: 'POST',
							page: true,
							id: 'table-load',
							toolbar: '#toolbarDemo',
							sort: true, //开启预排序
							initSort:{ //预排序
								field:'id', //排序字段，对隐藏列无效
								type:'desc', //asc正序，desc倒序
							},
							cols: [
								[
									{field: 'id', title: '订单编号', align: 'center', sort: true, width: '10%'},
									{field: 'goodsName', title: '商品名称', align: 'center'},
									{
										field: 'picture', title: '图片', align: 'center',width: 400,
										templet: function (line) {
											var obj;
											$.ajax({
												type: "GET",
												url: "/goods/getGoods?id=" + line.goodsId,
												async: false,
												cache: false,
												success: function (data) {
													obj = data;
												}
											})
											return '<div><img src=\"../static/shop/img/' + obj.picture + '\"></div>';
										}
									},
									{field: 'number', title: '数量',sort: true, align: 'center'},
									{field: 'sumSalePrice', title: '总价',sort: true, align: 'center'},
									{field: 'state', title: '状态', align: 'center'},
									{field: 'logistics', title: '物流单号', align: 'center'},
									{
										title: '操作', align: 'center', fixed: 'right', width:130,
										toolbar: '#orderBar'
									},
								]
							]
						});
						// 监听头工具栏事件（查询）
						table.on('toolbar(demo)', function (obj) {
							switch (obj.event) {
									//查询
								case 'querySearch':
									var param = $('#param').val();
									table.reload('table-load', {/*刷新当前页面,绿色为当前页面表格id*/
										where: {
											param: param
										}
									});
									$('#param').val(param);/*重现查询内容，防止与页面一同刷新*/
									break;
							}
						});
						// //监听
						table.on('tool(demo)', function (obj) {
							var data = obj.data;
							switch (obj.event) {
								case 'Alipay':
									layui.use(['table','layer'],function () {
										var $ = layui.$;
										var layer = layui.layer;
										layer.open({
											type: 2,
											title: '付款页面',
											content: '/goods/payPage?id=' + data.id + '&check=Alipay',
											shade: [0.8, '#393d49'],//透明度
											area: ['600px', '750px'],
											btn: ['模拟付款成功', '取消'],
											yes: function (index, layero) {
												var iframeWindow = window['layui-layer-iframe' + index];
												var submit = layero.find('iframe').contents().find("#LAY-front-submit");
												//监听提交(模拟付款成功)
												iframeWindow.layui.form.on('submit(LAY-front-submit)', function (data) {
													$.ajax({
														url: '/goods/pay',
														data: data.field,
														async: false,
														cache: false,
														success: function (str) {
															if (str.code === 0) {
																layer.msg(str.msg,{icon:str.icon,anim:str.anim},function (){
																	location.href="/goods/customer?type=orderRetail";
																});
															}
														}
													});
													layer.close(index);
												});
												submit.trigger('click');
											},
											success: function (layero, index) {
											}
										});
									})
									break;
								case 'WeChatPay':
									layui.use(['table','layer'],function () {
										var $ = layui.$;
										var layer = layui.layer;
										layer.open({
											type: 2,
											title: '付款页面',
											content: '/goods/payPage?id=' + data.id + '&check=WeChatPay',
											shade: [0.8, '#393d49'],//透明度
											area: ['600px', '750px'],
											btn: ['模拟付款成功', '取消'],
											yes: function (index, layero) {
												var iframeWindow = window['layui-layer-iframe' + index];
												var submit = layero.find('iframe').contents().find("#LAY-front-submit");
												//监听提交(模拟付款成功)
												iframeWindow.layui.form.on('submit(LAY-front-submit)', function (data) {
													$.ajax({
														url: '/goods/pay',
														data: data.field,
														async: false,
														cache: false,
														success: function (str) {
															if (str.code === 0) {
																layer.msg(str.msg,{icon:str.icon,anim:str.anim},function (){
																	location.href="/goods/customer?type=orderRetail";
																});
															}
														}
													});
													layer.close(index);
												});
												submit.trigger('click');
											},
											success: function (layero, index) {
											}
										});
									})
									break;
								case 'cancel':
									console.log(data)
									layui.use(['table','layer'],function () {
										var $ = layui.$;
										var layer = layui.layer;
										layer.confirm('确认取消？',function (index) {
											$.ajax({
												url: '/goods/cancel?id=' +data.id,
												data: null,
												async: false,
												cache: false,
												success: function (str) {
													table.reload('table-load');
													layer.msg(str.msg,{icon:str.icon,anim:str.anim});
												}
											});
										})
									})
									break;
								case 'receive':
									console.log(data)
									break;
								case 'service':
									console.log(data)
									break;
								case 'review':
									console.log(data)
									break;
							}
						});
					});
					break;
				case 'combination':
					layui.use(['form', 'table'], function () {
						var $ = layui.$;
						var table = layui.table;
						$("#table").html(
								"<table className=\"layui-table\" id=\"demo\" lay-filter=\"demo\">" +
								"<thead>" +
								"<tr>" +
								"<th lay-data=\"{field:'id', align: 'center', hide: 'true'}\">商品id</th>" +//隐藏列
								"<th lay-data=\"{field:'name', align: 'center'}\">商品名称</th>" +
								"<th lay-data=\"{field:'category', align: 'center', width:150}\">商品类别</th>" +
								"<th lay-data=\"{field:'picture', align: 'center',width:300}\">商品图片</th>" +
								"<th lay-data=\"{field:'salePrice', align: 'center', width:150 , sort: true}\">商品售价</th>" +
								"<th lay-data=\"{title: '操作', align: 'center', width:150, toolbar: '#combinationBar', fixed: 'right'}\">操作</th>" +
								"</tr>" +
								"</thead>" +
								"<tbody id=\"stock\">" +
								"</tbody>" +
								"</table>"
						);
						$.ajax({
							url: '/shop/getCombination',
							dataType: 'json',
							type: 'POST',
							cache: false,
							success: function (list) {
								//动态生成静态表格
								for (var i = 0; i < list.length; i++) {
									$.ajax({
										url: '/goods/getGoods?id=' + list[i],
										dataType: 'json',
										type: 'POST',
										cache: false,
										success: function (data) {
											var category = null;
											switch (data.category) {
												case "motherboard":
													category = "主板";
													break;
												case "cpu":
													category = "芯片";
													break;
												case "graphicscard":
													category = "显卡";
													break;
												case "ram":
													category = "内存";
													break;
												case "ssd":
													category = "硬盘";
													break;
												case "heatsink":
													category = "散热器";
													break;
												case "power":
													category = "电源";
													break;
												case "case":
													category = "机箱";
													break;
												default:
													return null;
											}
											$('#stock').append("<tr><td>" + data.id + "</td><td>" + data.name + "</td><td>" + category + "</td><td><div><img src=\"../static/shop/img/" + data.picture + "\"></div></td><td>" + data.salePrice + "</td></tr>");
											//layui表格模块重新渲染
											table.init('demo', {
												toolbar: '#combinationBuy',
												height: 1000,
												limit: 8,
											});
											table.on('tool(demo)', function (obj) {
												var data = obj.data;
												switch (obj.event) {
													case 'detail':
														location.href = "/goods/product?id=" + data.id
														break;
												}
											});
											table.on('toolbar(demo)', function (obj) {
												switch (obj.event) {
													case 'buyAll':
														location.href="/goods/checkoutCombination?combination="+list.join();
														break;
												}
											})
										}
									})
								}
							}
						})
					});
					break;
				case 'orderCombination':
					layui.use(['form', 'table'], function () {
						var $ = layui.$;
						var table = layui.table;
						$("#table").html("<table className=\"layui-table\" id=\"demo\" lay-filter=\"demo\"></table>");
						table.render({
							elem: '#demo',
							height: 2470,
							url: '/shop/orderCombinationQueryPage',
							method: 'POST',
							page: true,
							id: 'table-load',
							sort: true, //开启预排序
							initSort:{ //预排序
								field:'id', //排序字段，对隐藏列无效
								type:'desc', //asc正序，desc倒序
							},
							cols: [
								[
									{field: 'id', title: '订单编号', align: 'center', sort: true, width: '10%'},
									{field: 'motherboardId', title: '主板', align: 'center',
										templet:function (line){
											var name;
											$.ajax({
												type: "GET",
												url: "/goods/getGoods",
												data: {id: line.motherboardId},
												async: false,
												cache: false,
												success:function (data){
													name = data.name;
												}
											})
											return name;
										}
									},
									{field: 'cpuId', title: '芯片', align: 'center',
										templet:function (line){
											var name;
											$.ajax({
												type: "GET",
												url: "/goods/getGoods",
												data: {id: line.cpuId},
												async: false,
												cache: false,
												success:function (data){
													name = data.name+"￥"+line.cpuSalePrice;
												}
											})
											return name;
										}
									},
									{field: 'gcId', title: '显卡', align: 'center',
										templet:function (line){
											var name;
											$.ajax({
												type: "GET",
												url: "/goods/getGoods",
												data: {id: line.gcId},
												async: false,
												cache: false,
												success:function (data){
													name = data.name+"￥"+line.gcSalePrice;
												}
											})
											return name;
										}
									},
									{field: 'ramId', title: '内存', align: 'center',
										templet:function (line){
											var name;
											$.ajax({
												type: "GET",
												url: "/goods/getGoods",
												data: {id: line.ramId},
												async: false,
												cache: false,
												success:function (data){
													name = data.name+"￥"+line.ramSalePrice;
												}
											})
											return name;
										}
									},
									{field: 'ssdId', title: '硬盘', align: 'center',
										templet:function (line){
											var name;
											$.ajax({
												type: "GET",
												url: "/goods/getGoods",
												data: {id: line.ssdId},
												async: false,
												cache: false,
												success:function (data){
													name = data.name+"￥"+line.ssdSalePrice;
												}
											})
											return name;
										}
									},
									{field: 'heatsinkId', title: '散热器', align: 'center',
										templet:function (line){
											var name;
											$.ajax({
												type: "GET",
												url: "/goods/getGoods",
												data: {id: line.heatsinkId},
												async: false,
												cache: false,
												success:function (data){
													name = data.name+"￥"+line.heatsinkSalePrice;
												}
											})
											return name;
										}
									},
									{field: 'powerId', title: '电源', align: 'center',
										templet:function (line){
											var name;
											$.ajax({
												type: "GET",
												url: "/goods/getGoods",
												data: {id: line.powerId},
												async: false,
												cache: false,
												success:function (data){
													name = data.name+"￥"+line.powerSalePrice;
												}
											})
											return name;
										}
									},
									{field: 'caseId', title: '机箱', align: 'center',
										templet:function (line){
											var name;
											$.ajax({
												type: "GET",
												url: "/goods/getGoods",
												data: {id: line.caseId},
												async: false,
												cache: false,
												success:function (data){
													name = data.name+"￥"+line.caseSalePrice;
												}
											})
											return name;
										}
									},
									{field: 'sumSalePrice', title: '总价',sort: true, align: 'center'},
									{field: 'state', title: '状态', align: 'center'},
									{field: 'logistics', title: '物流单号', align: 'center'},
									{
										title: '操作', align: 'center', fixed: 'right', width:130,
										toolbar: '#orderBar'
									},
								]
							]
						});
					});
					break;
				case 'ownInfo':
					layui.use(['form', 'table'], function () {
						var $ = layui.$;
						var table = layui.table;
						$("#table").html(
								"<table className=\"layui-table\" id=\"demo\" lay-filter=\"demo\">" +
								"<thead>" +
								"<tr>" +
								"<th lay-data=\"{field:'id', align: 'center'}\">地址序号</th>" +
								"<th lay-data=\"{field:'address', align: 'center'}\">收货地址</th>" +
								"<th lay-data=\"{title: '操作', align: 'center', width:150, toolbar: '#infoBar', fixed: 'right'}\">操作</th>" +
								"</tr>" +
								"</thead>" +
								"<tbody id=\"stock\">" +
								"</tbody>" +
								"</table>"
						);
						$.ajax({
							url: '/shop/getAddress',
							type: 'GET',
							dataType: 'json',
							async: false,
							cache: false,
							success: function (list) {
								for (var i = 0; i < list.length; i++) {
									if(i==0){
										$('#stock').append("<tr><td>默认地址</td><td>"+list[i]+"</td></tr>");
									}else {
										$('#stock').append("<tr><td>"+i+"</td><td>"+list[i]+"</td></tr>");
									}
								}
								table.init('demo', {
									toolbar: '#address', //渲染头工具栏
									height: 600,
									limit: 10,
								});
								//监听行工具栏
								table.on('tool(demo)', function (obj) {
									var data = obj.data;
									switch (obj.event) {
										case 'default':
											layer.confirm('确认设置为默认地址？', function () {
												$.ajax({
													url: '/shop/setDefaultAddress?address=' + data.address,
													data: null,
													async: false,
													cache: false,
													success: function (str) {
														layer.msg(str.msg, {icon: str.icon, anim: str.anim});
														location.href = "/goods/customer?type=ownInfo"
													}
												});
											})
											break;
										case 'del':
											layer.confirm('确认删除？', function () {
												$.ajax({
													url: '/shop/delAddress?address=' + data.address,
													data: null,
													async: false,
													cache: false,
													success: function (str) {
														layer.msg(str.msg, {icon: str.icon, anim: str.anim});
														location.href = "/goods/customer?type=ownInfo"
													}
												});
											})
											break;
									}
								});
								//监听头工具栏
								table.on('toolbar(demo)', function (obj) {
									switch (obj.event) {
											//添加地址
										case 'add':
											layer.open({
												type: 2,
												title: '新增地址',
												content: '/shop/addressPage',
												shade: [0.8, '#393d49'],
												area: ['600px', '400px'],
												btn: ['提交', '取消'],
												yes: function (index, layero) {
													var iframeWindow = window['layui-layer-iframe' + index];
													var submit = layero.find('iframe').contents().find("#LAY-front-submit");
													//监听提交
													iframeWindow.layui.form.on('submit(LAY-front-submit)', function (data) {
														var field = data.field;
														$.ajax({
															url: '/shop/addAddress',
															data: {
																address: field.area1 + field.area2 + field.address,
																flag: field.flag,
															},
															async: false,//提交等待,是否异步
															cache: false,//缓存
															success: function (str) {
																if (str.code === 0) {
																	location.href="/goods/customer?type=ownInfo"
																}
																layer.msg(str.msg, {icon: str.icon, anim: str.anim});
															}
														});
														layer.close(index);//关闭弹窗
													});
													submit.trigger('click');//触发该元素点击事件
												},
												success: function (layero, index) {
												}
											});
											break;
									}
								})
							},
						})
					})
					break;
			}
		})
	</script>

		<!--导航栏切换-->
		<script>
			function changePage(page){
				location.href="/goods/customer?type="+page;
			}
		</script>

		<!--心愿单操作-->
		<script type="text/html" id="loveBar">
			<a class="layui-btn layui-btn-normal" lay-event="buy">立即购买</a>
			<a class="layui-btn layui-btn-danger" lay-event="del">取消收藏</a>
		</script>

		<!--购物车操作-->
		<script type="text/html" id="cartBar">
			<a class="layui-btn layui-btn-normal" lay-event="buy">立即购买</a>
			<a class="layui-btn layui-btn-danger" lay-event="del">删除商品</a>
		</script>
		<script type="text/html" id="cartInput">
			<div class="input-number">
				<input type="number" id="number" value="{{d.number}}" readonly="readonly">
				<span class="qty-up" lay-event="plus">+</span>
				<span class="qty-down" lay-event="reduce">-</span>
			</div>
		</script>
		<!--购物车工具栏-->
		<script type="text/html" id="cartList">
			<span class="layui-btn layui-btn-sm layui-bg-red" lay-event="buyCheck">
				<i class="layui-icon">&#xe615;</i>结算选中
			</span>
		</script>

		<!--订单头工具栏-->
		<script type="text/html" id="toolbarDemo">
			<!--查询-->
			<span class="layui-inline" style="width: 240px;">
				<input class="layui-input" name="param" id="param" placeholder="商品名称查询" autocomplete="off">
			</span>
			<span class="layui-btn layui-btn-sm layui-bg-red" lay-event="querySearch">
				<i class="layui-icon">&#xe615;</i>查询
			</span>
		</script>
		<!--订单操作-->
		<script type="text/html" id="orderBar">
			{{#  if(d.state == "未付款"){ }}<!--判断起始-->
			<a class="layui-btn layui-btn-normal" lay-event="Alipay">支付宝付款</a>
			<a class="layui-btn" lay-event="WeChatPay">微信付款</a>
			<a class="layui-btn layui-btn-danger" lay-event="cancel">取消订单</a>
			{{#  } }}<!--结束判断-->
			{{#  if(d.state == "已付款"){ }}
			<a class="layui-btn layui-btn-danger" lay-event="cancel">取消订单</a>
			{{#  } }}
			{{#  if(d.state == "已发货"){ }}
			<a class="layui-btn layui-btn-warm" lay-event="receive">确认收货</a>
			{{#  } }}
			{{#  if(d.state == "已签收"){ }}
			<a class="layui-btn layui-btn-danger" lay-event="service">申请售后</a>
			<a class="layui-btn layui-btn-danger" lay-event="review">发表评价</a>
			{{#  } }}
<!--			{{#  if(d.state == "已完成"){ }}-->
<!--			{{#  } }}-->
<!--			{{#  if(d.state == "已取消"){ }}-->
<!--			{{#  } }}-->
		</script>
		<!--整机订单查看详情-->
		<script type="text/html" id="detail">
			<a class="layui-btn" lay-event="detail">查看详情</a>
		</script>

		<!--整机配置单操作-->
		<script type="text/html" id="combinationBar">
			<a class="layui-btn layui-btn-normal" lay-event="detail">查看详情</a>
		</script>
		<!--购物车工具栏-->
		<script type="text/html" id="combinationBuy">
			<span class="layui-btn layui-btn-sm layui-bg-red" lay-event="buyAll">
				<i class="layui-icon">&#xe615;</i>整机下单
			</span>
		</script>

		<!--收货地址操作-->
		<script type="text/html" id="infoBar">
			<a class="layui-btn layui-btn-normal" lay-event="default">设为默认</a>
			<a class="layui-btn layui-btn-danger" lay-event="del">删除地址</a>
		</script>
		<!--收货地址头工具栏-->
		<script type="text/html" id="address">
			<!--添加-->
			<span class="layui-inline" lay-event="add"><i class="layui-icon">&#xe654;</i> </span>
		</script>

		<!--进入页面获取当前用户，并分别渲染页面顶端-->
		<script>
			$(document).ready(function(){
				$.ajax({
					url: '/getUser',
					type: 'GET',
					dataType: 'json',
					async: false,
					cache: false,
					success: function (user) {
						$("#door").html("<li><i class=\"fa fa-user-o\"><a onclick='safe()'>" + user.name + "</a></li>\r" +
								"<li><i class=\"fa fa-warning\"></i><a href=\"/logout\">" + "退出" + "</a></li>");
						$.ajax({
							url: '/shop/getLoveAndCart?id='+user.id,
							type: 'GET',
							async: false,
							cache: false,
							success: function (list){
								$("#loveNumber").text(list[0]);
								$("#cartNumber").text(list[1]);
							}
						})
					},
					error: function (){
						$("#door").html("<li><a href=\"/login\">" + "登录或注册" + "</a></li>");
					}
				})
			})
		</script>
	<!--layui表格显示图片必备样式，注：样式放置在最下方以覆盖原有样式-->
	<style>
		.layui-table-cell{
			text-align:center;
			height: auto;
			white-space: normal;
		}
		.layui-table img{
			max-width:220px
		}
		/*.layui-input{*/
		/*	width: 50px;*/
		/*}*/
	</style>

	</body>
</html>
